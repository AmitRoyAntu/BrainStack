<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BrainStack</title>
    <link rel="stylesheet" href="style.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <!-- Landing Page Section -->
    <div id="landing-page">
      <nav class="landing-nav">
        <div class="logo"><span class="iconify" data-icon="lucide:brain" style="color: var(--primary); margin-right: 10px;"></span> BrainStack</div>
        <div class="nav-actions">
            <button class="btn-login-nav" onclick="showLogin()">Sign In</button>
            <button class="btn-hero-pri" onclick="showLogin()" style="padding: 10px 24px; font-size: 1rem;">Get Started</button>
        </div>
      </nav>

      <header class="hero-section">
        <div class="hero-content">
          <h1>Your Second Brain for <span class="highlight">Deep Learning</span></h1>
          <p>The professional knowledge management system designed to track what you learn, organize notes via Markdown, and chat with your AI assistant.</p>
          <div class="hero-btns">
            <button class="btn-hero-pri" onclick="showLogin()">Get Started</button>
            <a href="#features" class="btn-hero-sec">Explore Features</a>
          </div>
        </div>
        <div class="hero-visual">
            <div class="visual-card">
                <div class="visual-header">
                    <div class="dots"><span></span><span></span><span></span></div>
                    <div class="visual-ai-badge"><span class="iconify" data-icon="lucide:sparkles" style="margin-right: 4px;"></span> AI Active</div>
                </div>
                <div class="visual-body">
                    <div class="visual-note-card">
                        <div class="visual-line short"></div>
                        <div class="visual-line long"></div>
                        <div class="visual-line medium"></div>
                    </div>
                    <div class="visual-stats-row">
                        <div class="visual-stat-item"></div>
                        <div class="visual-stat-item"></div>
                        <div class="visual-stat-item"></div>
                    </div>
                    <div class="visual-code-block">
                        <div class="visual-line" style="width: 40%; background: #8b5cf6;"></div>
                        <div class="visual-line" style="width: 70%; background: #6366f1;"></div>
                        <div class="visual-line" style="width: 50%; background: #8b5cf6;"></div>
                    </div>
                </div>
            </div>
        </div>
      </header>

      <section id="features" class="features-section">
        <div class="feature-card">
          <div class="feature-icon"><span class="iconify" data-icon="lucide:bot" style="color: var(--primary);"></span></div>
          <h3>AI Assistant</h3>
          <p>Chat with your entire note library using our context-aware Llama 3 assistant.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon"><span class="iconify" data-icon="lucide:bar-chart-3" style="color: var(--primary);"></span></div>
          <h3>Visual Analytics</h3>
          <p>Track your progress with professional charts and GitHub-style consistency heatmaps.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon"><span class="iconify" data-icon="lucide:folder-open" style="color: var(--primary);"></span></div>
          <h3>Structured Library</h3>
          <p>Organize everything with categories, tags, and powerful server-side search.</p>
        </div>
      </section>

      <section class="services-section">
          <h2>Everything you need to <span class="highlight">master</span> any topic</h2>
          <div class="service-list">
              <div class="service-item">‚úì Markdown Editor with Live Preview</div>
              <div class="service-item">‚úì One-Click Code Copying</div>
              <div class="service-item">‚úì Flashcard Revision Center</div>
              <div class="service-item">‚úì Full JSON Data Portability</div>
          </div>
      </section>

      <footer class="landing-footer">
        <p>&copy; 2026 BrainStack. Built for the curious. üå±</p>
      </footer>
    </div>

    <div class="app-container hidden">

      <aside class="sidebar">
        <div class="sidebar-header">
          <div class="logo"><span class="iconify" data-icon="lucide:brain" style="color: var(--primary); margin-right: 8px;"></span> BrainStack</div>
          <button class="mobile-toggle" onclick="toggleSidebar()"><span class="iconify" data-icon="lucide:panel-left"></span></button>
        </div>
        <nav id="dynamic-nav">
          <!-- Dynamic Content -->
        </nav>
        <div class="user-profile" onclick="router('settings')" title="Go to Settings">
          <div class="avatar" id="side-avatar">..</div>
          <div class="profile-details">
            <span id="side-name" class="profile-name">Loading...</span>
            <span id="side-status" class="profile-role">Syncing...</span>
          </div>
        </div>
        <button class="btn-logout-sidebar" onclick="logout()" title="Sign Out">
          <span class="iconify" data-icon="lucide:log-out" style="font-size: 1.2rem;"></span> <span class="logout-text">Sign Out</span>
        </button>


      </aside>

      <!-- Mobile Sidebar Overlay -->
      <div id="sidebar-overlay" class="hidden" onclick="toggleSidebar()"></div>

      <main class="main-content">
        
        <header class="top-bar">
          <button class="mobile-menu-trigger" onclick="toggleSidebar()">
            <span class="iconify" data-icon="lucide:panel-left"></span>
          </button>
          <div class="search-container">
            <span class="search-icon"><span class="iconify" data-icon="lucide:search"></span></span>
            <input type="text" id="globalSearch" placeholder="Search notes (Cmd+K)..." />
            <button id="search-clear" class="hidden" onclick="clearSearch()">‚úï</button>
          </div>
        </header>


        <section id="view-dashboard" class="view active">
          
          <!-- Welcome Section -->
          <div class="dashboard-welcome">
            <div>
              <h1 id="dash-greeting">Hello, Learner! üëã</h1>
              <p id="dash-quote" style="color: var(--text-muted); margin-top: 5px; font-style: italic;">"The expert in anything was once a beginner."</p>
            </div>
            <button class="btn-pri" onclick="resetAddForm()"><span class="iconify" data-icon="lucide:plus"></span> New Entry</button>
          </div>
          
          <!-- Key Stats -->
          <div class="stats-grid">
            <div class="card stat-card">
              <div class="stat-icon-bg icon-blue"><span class="iconify" data-icon="lucide:book-open"></span></div>
              <div>
                <h3 style="font-size:0.85rem; color:var(--text-muted); text-transform:uppercase; letter-spacing:0.5px; font-weight: 600;">Total Learned</h3>
                <div class="stat-value" id="stat-total" style="color:var(--text-main);">0</div>
              </div>
            </div>
            
            <div class="card stat-card">
               <div class="stat-icon-bg icon-red"><span class="iconify" data-icon="lucide:flame"></span></div>
               <div>
                <h3 style="font-size:0.85rem; color:var(--text-muted); text-transform:uppercase; letter-spacing:0.5px; font-weight: 600;">Current Streak</h3>
                <div class="stat-value" id="stat-streak">0 Days</div>
               </div>
            </div>

            <div class="card stat-card warning" onclick="startRevision()" style="cursor:pointer; transition:all 0.2s;">
               <div class="stat-icon-bg icon-yellow"><span class="iconify" data-icon="lucide:repeat"></span></div>
               <div>
                <h3 style="font-size:0.85rem; color:var(--text-muted); text-transform:uppercase; letter-spacing:0.5px; font-weight: 600;">To Review</h3>
                <div class="stat-value" id="stat-revision" style="color:var(--accent-warn);">0</div>
               </div>
            </div>
          </div>
          
          <!-- Charts Section -->
          <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap:25px; margin-bottom:40px;">
              <div class="card" style="padding: 25px;">
                  <h3 style="margin-bottom: 15px; font-size: 1.1rem; display: flex; align-items: center; gap: 8px;">
                    <span class="iconify" data-icon="lucide:pie-chart" style="color: var(--primary);"></span> Category Distribution
                  </h3>
                  <div style="height: 250px; display: flex; justify-content: center;">
                    <canvas id="chart-category"></canvas>
                  </div>
              </div>
              <div class="card" style="padding: 25px;">
                  <h3 style="margin-bottom: 15px; font-size: 1.1rem; display: flex; align-items: center; gap: 8px;">
                    <span class="iconify" data-icon="lucide:trending-up" style="color: var(--primary);"></span> Learning Activity (7 Days)
                  </h3>
                  <div style="height: 250px;">
                    <canvas id="chart-activity"></canvas>
                  </div>
              </div>
          </div>


          <!-- Heatmap Section -->
          <div class="card" style="padding: 25px; margin-bottom: 40px;">
              <h3 style="margin-bottom: 20px; font-size: 1.1rem; display: flex; align-items: center; gap: 8px;">
                <span class="iconify" data-icon="lucide:flame" style="color: #ef4444;"></span> Learning Consistency
              </h3>
              <div class="heatmap-wrapper">
                  <div id="heatmap-grid" class="heatmap-grid"></div>
              </div>
              <div class="heatmap-legend" style="display: flex; gap: 5px; align-items: center; justify-content: flex-end; margin-top: 10px; font-size: 0.75rem; color: var(--text-muted);">
                  <span>Less</span>
                  <div class="h-cell level-0"></div>
                  <div class="h-cell level-1"></div>
                  <div class="h-cell level-2"></div>
                  <div class="h-cell level-3"></div>
                  <div class="h-cell level-4"></div>
                  <span>More</span>
              </div>
          </div>

          <!-- Recent Activity -->

          <h3 style="margin-bottom: 20px; font-size: 1.2rem;">Recent Activity</h3>
          <div id="recent-list" class="list-group" style="display: grid; gap: 15px;"></div>
        </section>

        <section id="view-library" class="view hidden">
          <div class="filter-bar" style="display:flex; gap:30px; margin-bottom:25px; flex-wrap:wrap; align-items:center; background:var(--card-bg); padding:20px; border-radius:12px; border:1px solid var(--border);">
            <div style="display:flex; align-items:center; gap:12px;">
              <span style="font-size:0.85rem; font-weight:600; color:var(--text-muted);">üìÅ Category:</span>
              <select id="filter-category" onchange="fetchEntries(true)" style="width:auto; min-width:140px; margin:0; padding:8px; font-size:0.9rem;">
                <option value="">All Categories</option>
              </select>
            </div>
            <div style="display:flex; align-items:center; gap:8px;">
              <span style="font-size:0.85rem; font-weight:600; color:var(--text-muted);">‚≠ê Difficulty:</span>
              <select id="filter-difficulty" onchange="fetchEntries(true)" style="width:auto; min-width:140px; margin:0; padding:8px; font-size:0.9rem;">
                <option value="">Any Difficulty</option>
                <option value="1">1 - Beginner</option>
                <option value="2">2 - Easy</option>
                <option value="3">3 - Medium</option>
                <option value="4">4 - Hard</option>
                <option value="5">5 - Expert</option>
              </select>
            </div>
            <button class="btn-xs" onclick="resetFilters()" style="margin-left:auto; color:var(--primary); background:none; border:1px solid var(--primary); padding:5px 10px; border-radius:6px; cursor:pointer;">Reset All</button>


          </div>
          <div id="library-list" class="card-grid"></div>
          
          <!-- Pagination Bar -->
          <div id="pagination-bar" class="pagination-bar hidden">
            <button id="btn-prev" class="btn-sec" onclick="changePage(-1)">‚Üê Previous</button>
            <span id="page-info" class="page-info">Page 1 of 1</span>
            <button id="btn-next" class="btn-sec" onclick="changePage(1)">Next ‚Üí</button>
          </div>
        </section>


        <section id="view-settings" class="view hidden">
          <div style="max-width: 800px; margin: 0 auto; position: relative;">
            <button class="mobile-toggle" onclick="toggleSidebar()" style="position: absolute; top: 0; right: 0;"><span class="iconify" data-icon="lucide:panel-left"></span></button>
            <button class="btn-sec" onclick="goBack()" style="margin-bottom: 25px">‚Üê Back</button>
            
            <h2 style="margin-bottom: 25px;">Profile & Settings</h2>

            <div style="display: grid; gap: 30px; width: 100%;">


              
              <!-- Profile Info Section -->
              <div class="card" style="padding: 30px; text-align: left;">
                <div style="border-bottom: 1px solid var(--border); padding-bottom: 20px; margin-bottom: 25px;">
                  <h3 style="margin-bottom: 5px;">üë§ Personal Profile</h3>
                  <p style="color:var(--text-muted); font-size: 0.95rem;">Customize how you appear in the app.</p>
                </div>
                
                <div class="input-group">
                  <label class="label-text">Display Name</label>
                  <input type="text" id="prof-name" placeholder="Your Name" />
                </div>

                <div class="input-group">
                  <label class="label-text">Bio / Learning Goal</label>
                  <textarea id="prof-bio" placeholder="e.g., Aspiring Full-Stack Developer" rows="2" style="margin-bottom: 20px;"></textarea>
                </div>

                <button class="btn-pri" onclick="saveProfile()" style="width: 100%;">Update Profile</button>
              </div>

              <!-- Appearance Section -->
              <div class="card" style="padding: 30px; text-align: left;">
                <div style="border-bottom: 1px solid var(--border); padding-bottom: 20px; margin-bottom: 25px;">
                  <h3 style="margin-bottom: 5px;">üé® Appearance</h3>
                  <p style="color:var(--text-muted); font-size: 0.95rem;">Customize your interface theme.</p>
                </div>
                
                <div style="display: flex; justify-content: space-between; align-items: center;">
                  <span style="font-weight: 500; font-size: 1.05rem;">Dark Mode</span>
                  <div class="theme-switch-wrapper">
                    <label class="theme-switch" for="checkbox">
                        <input type="checkbox" id="checkbox" onclick="toggleTheme()" />
                        <div class="slider round">
                            <span class="sun"><span class="iconify" data-icon="lucide:sun" style="font-size: 14px;"></span></span>
                            <span class="moon"><span class="iconify" data-icon="lucide:moon" style="font-size: 14px;"></span></span>
                        </div>
                    </label>
                  </div>
                </div>
              </div>
              
              <!-- Data Section -->
              <div class="card" style="padding: 30px; text-align: left;">
              <div style="border-bottom: 1px solid var(--border); padding-bottom: 20px; margin-bottom: 25px;">
                <h3 style="margin-bottom: 5px;">üíæ Data & Storage</h3>
                <p style="color:var(--text-muted); font-size: 0.95rem;">Manage your local learning data.</p>
              </div>

              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                <div>
                  <strong style="font-size: 1.05rem;">Export Backup</strong>
                  <p style="font-size: 0.9rem; color: var(--text-muted); margin-top:6px;">Download your data as a JSON file.</p>
                </div>
                <button class="btn-sec" onclick="exportData()" style="padding: 10px 20px;">‚¨áÔ∏è Export</button>
              </div>

              <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                  <strong style="font-size: 1.05rem;">Import Backup</strong>
                  <p style="font-size: 0.9rem; color: var(--text-muted); margin-top:6px;">Restore from a previously exported file.</p>
                </div>
                <button class="btn-sec" onclick="document.getElementById('inp-import').click()" style="padding: 10px 20px;">‚¨ÜÔ∏è Import</button>
              </div>
              
              <input type="file" id="inp-import" style="display:none" onchange="importData(this)" accept=".json" />
            </div>

            <!-- Danger Zone -->
            <div class="card" style="border: 1px solid #fee2e2; padding: 30px;">
              <h3 style="color: #ef4444; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">‚ö†Ô∏è Danger Zone</h3>
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                  <strong style="font-size: 1.05rem;">Clear All Data</strong>
                  <p style="font-size: 0.9rem; color: var(--text-muted); margin-top:6px;">Permanently remove all entries and settings.</p>
                </div>
                <button class="btn-remove" onclick="nukeData()" style="width: auto; height: auto; padding: 12px 24px; font-size: 1.2rem; display: flex; align-items: center; justify-content: center;"><span class="iconify" data-icon="lucide:trash-2"></span></button>
              </div>
            </div>
            
            <!-- App Info -->
            <div style="text-align: center; color: var(--text-muted); font-size: 0.9rem; margin-top: 30px; line-height: 1.6;">
                <p>BrainStack v1.0.0</p>
                <p>Keep learning, keep growing. üå±</p>
            </div>

          </div>
        </section>

        <section id="view-add" class="view hidden">
          <div style="max-width: 800px; margin: 0 auto; position: relative;">
            <button class="mobile-toggle" onclick="toggleSidebar()" style="position: absolute; top: 0; right: 0;"><span class="iconify" data-icon="lucide:panel-left"></span></button>
            <button class="btn-sec" onclick="goBack()" style="margin-bottom: 25px">‚Üê Back</button>

            <h2 id="view-add-title" style="margin-bottom: 25px;">Add New Learning</h2>
            
            <form id="add-form" class="card" style="padding: 30px;">
              <input type="hidden" id="inp-id" />
              
              <!-- Basic Info -->
              <div class="input-group">
                <label class="label-text">Title</label>
                <input type="text" id="inp-title" placeholder="e.g., CSS Grid Layout" required style="margin-bottom: 20px;" />
              </div>

              <div class="form-row" style="margin-bottom: 20px;">
                <div class="input-group">
                  <label class="label-text">Category</label>
                  <div class="category-wrapper" style="display: flex; gap: 10px;">
                    <select id="inp-category" style="margin: 0"></select>
                    <input type="text" id="inp-new-category" class="hidden" placeholder="New Category..." style="margin: 0" />
                    <button type="button" class="btn-icon" onclick="toggleCategoryInput()" title="Add New Category" style="width: 45px; min-width: 45px;">+</button>
                  </div>
                </div>
                <div class="input-group">
                  <label class="label-text">Date</label>
                  <input type="date" id="inp-date" required style="margin: 0" />
                </div>
              </div>

              <!-- Difficulty -->
              <div class="input-group" style="background: var(--bg); padding: 15px; border-radius: 8px; margin-bottom: 25px;">
                <label class="label-text" style="display: flex; justify-content: space-between;">
                  Difficulty <span><strong id="diff-label" style="color: var(--primary)">Beginner</strong></span>
                </label>
                <input type="range" id="inp-difficulty" min="1" max="5" value="1" step="1" />
                <div class="slider-ticks">
                  <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
                </div>
              </div>

              <!-- Content Editor -->
              <div class="input-group">
                <label class="label-text">Notes (Markdown)</label>
                <div class="markdown-editor">
                  <div class="toolbar">
                    <div class="tools">
                      <button type="button" onclick="formatDoc('bold')"><b>B</b></button>
                      <button type="button" onclick="formatDoc('italic')"><i>I</i></button>
                      <button type="button" onclick="formatDoc('code')">&lt;/&gt;</button>
                      <button type="button" onclick="formatDoc('list')"><span class="iconify" data-icon="lucide:list"></span></button>
                      <button type="button" onclick="formatDoc('h2')">H2</button>
                    </div>
                    <button type="button" class="btn-xs" onclick="togglePreview()">üëÅÔ∏è Preview</button>
                  </div>
                  <textarea id="inp-notes" placeholder="# Write your notes..." rows="12"></textarea>
                  <div id="preview-panel" class="preview-box markdown-body hidden"></div>
                </div>
              </div>

              <!-- Tags & Resources -->
              <div class="form-row" style="margin-top: 10px;">
                <div class="input-group">
                  <label class="label-text">Tags</label>
                  <div class="tag-container" id="tag-container" onclick="document.getElementById('inp-tags').focus()">
                    <input type="text" id="inp-tags" placeholder="Press Enter..." />
                  </div>
                </div>
                <div class="input-group">
                  <label class="label-text">Resources</label>
                  <div id="resource-list"></div>
                  <button type="button" class="btn-dashed" onclick="addResourceField()">+ Add Link</button>
                </div>
              </div>

              <div class="input-group">
                <label class="checkbox-label" style="margin: 20px 0;">
                  <input type="checkbox" id="inp-revision" />
                  <span>Mark for later revision</span>
                </label>
              </div>

              <div class="form-actions" style="border-top: 1px solid var(--border); padding-top: 25px; display: flex; justify-content: flex-end; align-items: center; gap: 12px;">
                <span id="draft-status" style="font-size: 0.8rem; color: var(--text-muted); opacity: 0; transition: opacity 0.3s;">Draft Saved</span>
                <button type="button" class="btn-sec" onclick="goBack()">Cancel</button>
                <button type="submit" class="btn-pri" id="btn-save" style="min-width: 150px;">Save Entry</button>
              </div>
            </form>
          </div>
        </section>

        <section id="view-revision" class="view hidden">
          <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:30px;">
            <div style="display: flex; align-items: center; gap: 15px;">
              <h2>‚ö° Revision Center</h2>
            </div>
            <button class="btn-sec" onclick="router('dashboard')">Exit</button>
          </div>

          
          <div id="revision-list-container">
            <div class="card" style="margin-bottom: 25px; padding: 25px; display: flex; justify-content: space-between; align-items: center; background: var(--primary-light); border: none;">
              <div>
                <h3 style="color: var(--primary);">Ready to study?</h3>
                <p style="color: var(--primary); opacity: 0.8;">Go through your flagged notes one by one.</p>
              </div>
              <button class="btn-pri" onclick="startFlashcardSession()" style="box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);">Start Flashcards</button>
            </div>

            <h3 style="margin-bottom: 15px;">Entries to Review</h3>
            <div id="rev-list-items" class="list-group" style="display: grid; gap: 10px;"></div>
          </div>

          <div id="revision-session-container" class="hidden">
            <div style="text-align: center; margin-bottom: 25px;">
              <span id="rev-progress" style="font-size: 0.85rem; font-weight: 600; letter-spacing: 1px; color: var(--text-muted); background: var(--bg); padding: 6px 15px; border-radius: 20px; border: 1px solid var(--border);">CARD 1 OF 5</span>
            </div>

            <div id="flashcard-container" class="card flashcard" style="border-radius: 24px;">
               <div class="fc-front">
                  <span class="badge fc-category-badge" id="fc-category">Category</span>
                  <h2 id="fc-title" class="fc-title-text" style="color: var(--primary);">Title</h2>
                  <div id="fc-tags" class="tag-list" style="justify-content:center; border:none; background:transparent;"></div>
                  <p style="color: var(--text-muted); margin-top: 50px; font-size: 0.9rem; font-style: italic;">Tap card to reveal notes</p>
               </div>
               <div class="fc-back hidden">
                  <div id="fc-content" class="markdown-body"></div>
               </div>
            </div>

            <div id="fc-controls" class="fc-controls-container hidden">
               <button class="btn-pri btn-keep" onclick="processRevision(true)" style="padding: 15px 40px;">‚Ü∫ Keep Reviewing</button>
               <button class="btn-pri btn-mastered" onclick="processRevision(false)" style="padding: 15px 40px;">‚úì Mastered</button>
            </div>
            
            <div style="text-align: center; margin-top: 40px;">
              <button class="btn-sec" onclick="exitSession()" style="border: none; font-size: 0.9rem;">Cancel Session</button>
            </div>
          </div>


          <div id="revision-empty" class="hidden" style="text-align: center; padding: 80px 20px;">
             <div style="font-size: 4rem; margin-bottom: 20px;">üéâ</div>
             <h3>All caught up!</h3>
             <p style="color:var(--text-muted); margin-bottom: 30px;">You have no notes marked for revision right now.</p>
             <button class="btn-pri" onclick="router('library')">Browse Library</button>
          </div>
        </section>

        <section id="view-details" class="view hidden">
          <div style="max-width: 800px; margin: 0 auto 20px auto;">
            <button class="btn-sec" onclick="router('library')" style="padding: 8px 16px; font-size: 0.9rem;">
              <span class="iconify" data-icon="lucide:arrow-left" style="margin-right: 6px; vertical-align: middle;"></span> Back to Library
            </button>
          </div>


          <div class="card detail-card">
            <header class="detail-header">
              <div class="meta-top">
                <span class="badge" id="detail-category">Category</span>
                <span class="date-text" id="detail-date">Date</span>
              </div>
              <h1 id="detail-title">Title</h1>
              <div class="difficulty-dots" id="detail-diff">‚óè‚óè‚óè‚óã‚óã</div>
            </header>

            <hr class="divider" />

            <!-- AI Summary Section -->
            <div id="detail-summary-section" style="margin-bottom: 25px;">
                <button id="btn-summarize" class="btn-sec btn-ai-summary" onclick="summarizeEntry()">
                    <span class="iconify" data-icon="lucide:sparkles" style="margin-right: 6px;"></span> AI Summarize
                </button>
                <div id="ai-summary-box" class="hidden" style="margin-top: 15px; background: linear-gradient(to right, var(--bg), var(--card-bg)); border-left: 4px solid var(--primary); padding: 15px; border-radius: 4px;">
                    <h4 style="margin-bottom: 8px; color: var(--primary); display: flex; align-items: center; gap: 6px;"><span class="iconify" data-icon="lucide:bot"></span> Quick Summary</h4>
                    <div id="ai-summary-content" class="markdown-body" style="font-size: 0.95rem;"></div>
                </div>
            </div>

            <div id="detail-content" class="markdown-body"></div>

            <div class="detail-footer">
              <div id="detail-resources" class="res-list"></div>
              <div id="detail-tags" class="tag-list"></div>
            </div>

            <div class="action-row" style="margin-top: 30px; display: flex; gap: 10px;">
              <button class="btn-sec" onclick="editEntry(null, currentViewId)" style="color: var(--primary); border-color: var(--primary); display: flex; align-items: center; gap: 6px;"><span class="iconify" data-icon="lucide:pencil"></span> Edit Entry</button>
              <button class="btn-remove" onclick="deleteCurrentEntry()" style="width: auto; padding: 10px 20px; background: #fee2e2; color: red; display: flex; align-items: center; gap: 6px;"><span class="iconify" data-icon="lucide:trash-2"></span> Delete Entry</button>
            </div>
          </div>
        </section>
      </main>
    </div>

    <div id="loading-overlay" class="hidden">
      <div class="spinner"></div>
      <p style="margin-top: 15px; font-weight: 500;">Syncing with BrainStack...</p>
    </div>

    <!-- Login Overlay -->
    <div id="login-overlay" class="hidden" onclick="handleOverlayClick(event)">
      <div class="login-wrapper">
        <div class="login-decoration"></div>
        <div class="login-card">
            <div style="text-align: center; margin-bottom: 30px;">
                <div style="font-size: 3rem; margin-bottom: 10px;">üß†</div>
                <h2>Welcome Back</h2>
                <p>Your Second Brain is ready.</p>
            </div>
            
            <form onsubmit="event.preventDefault(); loginUser();">
                <div class="login-input-group">
                    <label>Email Address</label>
                    <div class="input-with-icon">
                        <span class="iconify" data-icon="lucide:mail"></span>
                        <input type="email" id="login-email" placeholder="name@example.com" required autofocus />
                    </div>
                </div>
                
                <div class="login-input-group">
                    <label>Password</label>
                    <div class="input-with-icon">
                        <span class="iconify" data-icon="lucide:lock"></span>
                        <input type="password" id="login-pass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required />
                        <button type="button" onclick="togglePasswordVisibility(this)" class="btn-eye" title="Show Password">
                            <span class="iconify" data-icon="lucide:eye"></span>
                        </button>
                    </div>
                </div>

                <button type="submit" class="btn-login" id="btn-login">Sign In <span class="iconify" data-icon="lucide:arrow-right"></span></button>
            </form>
            
            <button onclick="hideLogin()" class="btn-back">‚Üê Back to Home</button>
            <p id="login-error" class="hidden" style="color: #ef4444; font-size: 0.85rem; margin-top: 20px; font-weight: 600; text-align: center; background: rgba(239,68,68,0.1); padding: 10px; border-radius: 8px;">‚ùå Invalid credentials</p>
        </div>
      </div>
    </div>

    <!-- AI Assistant Floating Button -->
    <button class="ai-fab" onclick="toggleAIChat()" title="Ask BrainStack AI">
        <span class="iconify" data-icon="lucide:bot-message-square" style="font-size: 1.5rem;"></span>
    </button>

    <!-- AI Assistant Panel -->
    <div id="ai-panel" class="ai-panel hidden">
        <div id="ai-resize-handle" class="ai-resize-handle"></div>
        <div class="ai-panel-header">
            <button onclick="toggleAIChat()" class="btn-xs" style="color:white; border:none; font-size:1.5rem; background:none; cursor:pointer;">‚úï</button>
            <h3>BrainStack AI <span class="iconify" data-icon="lucide:bot" style="margin-left: 8px;"></span></h3>
        </div>
        <div id="ai-messages" class="ai-messages">
            <div class="ai-bubble bot">Hi! I've read all your notes. How can I help you today?</div>
        </div>
        <form class="ai-input-area" onsubmit="event.preventDefault(); sendAIMessage();">
            <input type="text" id="ai-input" placeholder="Ask your brain..." autocomplete="off" />
            <button type="submit">‚Üë</button>
        </form>
    </div>

    <div id="toast-container"></div>

    <script src="app.js"></script>
  </body>
</html>